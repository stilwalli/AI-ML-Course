<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>3f72363a30a44209ab643da8a366fc52</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="credit-card-users-churn-prediction" class="cell markdown"
id="9a54fa0f">
<h1>Credit Card Users Churn Prediction</h1>
</section>
<section id="problem-statement" class="cell markdown" id="9EaJ8AGwpM-2">
<h2>Problem Statement</h2>
</section>
<div class="cell markdown" id="x3-QehJxbp0t">
<h3 id="business-context">Business Context</h3>
<p>The Thera bank recently saw a steep decline in the number of users of
their credit card, credit cards are a good source of income for banks
because of different kinds of fees charged by the banks like annual
fees, balance transfer fees, and cash advance fees, late payment fees,
foreign transaction fees, and others. Some fees are charged to every
user irrespective of usage, while others are charged under specified
circumstances.</p>
<p>Customers’ leaving credit cards services would lead bank to loss, so
the bank wants to analyze the data of customers and identify the
customers who will leave their credit card services and reason for same
– so that bank could improve upon those areas</p>
<p>You as a Data scientist at Thera bank need to come up with a
classification model that will help the bank improve its services so
that customers do not renounce their credit cards</p>
<h3 id="data-description">Data Description</h3>
<ul>
<li>CLIENTNUM: Client number. Unique identifier for the customer holding
the account</li>
<li>Attrition_Flag: Internal event (customer activity) variable - if the
account is closed then "Attrited Customer" else "Existing Customer"</li>
<li>Customer_Age: Age in Years</li>
<li>Gender: Gender of the account holder</li>
<li>Dependent_count: Number of dependents</li>
<li>Education_Level: Educational Qualification of the account holder -
Graduate, High School, Unknown, Uneducated, College(refers to college
student), Post-Graduate, Doctorate</li>
<li>Marital_Status: Marital Status of the account holder</li>
<li>Income_Category: Annual Income Category of the account holder</li>
<li>Card_Category: Type of Card</li>
<li>Months_on_book: Period of relationship with the bank (in
months)</li>
<li>Total_Relationship_Count: Total no. of products held by the
customer</li>
<li>Months_Inactive_12_mon: No. of months inactive in the last 12
months</li>
<li>Contacts_Count_12_mon: No. of Contacts in the last 12 months</li>
<li>Credit_Limit: Credit Limit on the Credit Card</li>
<li>Total_Revolving_Bal: Total Revolving Balance on the Credit Card</li>
<li>Avg_Open_To_Buy: Open to Buy Credit Line (Average of last 12
months)</li>
<li>Total_Amt_Chng_Q4_Q1: Change in Transaction Amount (Q4 over Q1)</li>
<li>Total_Trans_Amt: Total Transaction Amount (Last 12 months)</li>
<li>Total_Trans_Ct: Total Transaction Count (Last 12 months)</li>
<li>Total_Ct_Chng_Q4_Q1: Change in Transaction Count (Q4 over Q1)</li>
<li>Avg_Utilization_Ratio: Average Card Utilization Ratio</li>
</ul>
<h4 id="what-is-a-revolving-balance">What Is a Revolving Balance?</h4>
<ul>
<li>If we don't pay the balance of the revolving credit account in full
every month, the unpaid portion carries over to the next month. That's
called a revolving balance</li>
</ul>
<h5 id="what-is-the-average-open-to-buy">What is the Average Open to
buy?</h5>
<ul>
<li>'Open to Buy' means the amount left on your credit card to use. Now,
this column represents the average of this value for the last 12
months.</li>
</ul>
<h5 id="what-is-the-average-utilization-ratio">What is the Average
utilization Ratio?</h5>
<ul>
<li>The Avg_Utilization_Ratio represents how much of the available
credit the customer spent. This is useful for calculating credit
scores.</li>
</ul>
<h5
id="relation-bw-avg_open_to_buy-credit_limit-and-avg_utilization_ratio">Relation
b/w Avg_Open_To_Buy, Credit_Limit and Avg_Utilization_Ratio:</h5>
<ul>
<li>( Avg_Open_To_Buy / Credit_Limit ) + Avg_Utilization_Ratio = 1</li>
</ul>
</div>
<section
id="please-read-the-instructions-carefully-before-starting-the-project"
class="cell markdown" id="NbHOIdlwcrqR">
<h3><strong>Please read the instructions carefully before starting the
project.</strong></h3>
<p>This is a commented Jupyter IPython Notebook file in which all the
instructions and tasks to be performed are mentioned.</p>
<ul>
<li>Blanks '_______' are provided in the notebook that needs to be
filled with an appropriate code to get the correct result. With every
'_______' blank, there is a comment that briefly describes what needs to
be filled in the blank space.</li>
<li>Identify the task to be performed correctly, and only then proceed
to write the required code.</li>
<li>Fill the code wherever asked by the commented lines like "# write
your code here" or "# complete the code". Running incomplete code may
throw error.</li>
<li>Please run the codes in a sequential manner from the beginning to
avoid any unnecessary errors.</li>
<li>Add the results/observations (wherever mentioned) derived from the
analysis in the presentation and submit the same.</li>
</ul>
</section>
<section id="importing-necessary-libraries" class="cell markdown"
id="v_-uuGqH-qTt">
<h2>Importing necessary libraries</h2>
</section>
<div class="cell code" id="83D17_Wl4jal">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing the libraries with the specified version.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment and run the following line if Google Colab is being used</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install scikit<span class="op">-</span>learn<span class="op">==</span><span class="fl">1.2.2</span> seaborn<span class="op">==</span><span class="fl">0.13.1</span> matplotlib<span class="op">==</span><span class="fl">3.7.1</span> numpy<span class="op">==</span><span class="fl">1.25.2</span> pandas<span class="op">==</span><span class="fl">1.5.3</span> imbalanced<span class="op">-</span>learn<span class="op">==</span><span class="fl">0.10.1</span> xgboost<span class="op">==</span><span class="fl">2.0.3</span> <span class="op">-</span>q <span class="op">--</span>user</span></code></pre></div>
</div>
<div class="cell code" id="XVB5DgmofkGQ">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing the libraries with the specified version.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment and run the following lines if Jupyter Notebook is being used</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install scikit-learn==1.2.2 seaborn==0.13.1 matplotlib==3.7.1 numpy==1.25.2 pandas==1.5.3 imblearn==0.12.0 xgboost==2.0.3 -q --user</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install --upgrade -q threadpoolctl</span></span></code></pre></div>
</div>
<div class="cell markdown" id="G3tBAjBgrLAQ">
<p><strong>Note</strong>: <em>After running the above cell, kindly
restart the notebook kernel and run all cells sequentially from the
start again</em>.</p>
</div>
<div class="cell code" data-execution_count="278" id="8I-FQB2qrNmM">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries to help with reading and manipulating data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># To suppress scientific notations</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.float_format&quot;</span>, <span class="kw">lambda</span> x: <span class="st">&quot;</span><span class="sc">%.3f</span><span class="st">&quot;</span> <span class="op">%</span> x)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Libaries to help with data visualization</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># To tune model, get different metric scores, and split data</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    f1_score,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    accuracy_score,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    recall_score,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    precision_score,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    confusion_matrix,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    roc_auc_score,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, StratifiedKFold, cross_val_score</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># To be used for data scaling and one hot encoding</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler, OneHotEncoder</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co"># To impute missing values</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># To oversample and undersample data</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.under_sampling <span class="im">import</span> RandomUnderSampler</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># To do hyperparameter tuning</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># To define maximum number of columns to be displayed in a dataframe</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.max_columns&quot;</span>, <span class="va">None</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># To supress scientific notations for a dataframe</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&quot;display.float_format&quot;</span>, <span class="kw">lambda</span> x: <span class="st">&quot;</span><span class="sc">%.3f</span><span class="st">&quot;</span> <span class="op">%</span> x)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co"># To help with model building</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> (</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    AdaBoostClassifier,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    GradientBoostingClassifier,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    RandomForestClassifier,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    BaggingClassifier,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># To supress warnings</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span></code></pre></div>
</div>
<section id="loading-the-dataset" class="cell markdown"
id="xxhpZv9y-qTw">
<h2>Loading the dataset</h2>
</section>
<div class="cell code" data-execution_count="279" id="oJnKoHy14jam">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ccchurn_ds <span class="op">=</span> pd.read_csv(<span class="st">&quot;BankChurners.csv&quot;</span>)</span></code></pre></div>
</div>
<section id="data-overview" class="cell markdown" id="UvpMDcaaMKtI">
<h2>Data Overview</h2>
</section>
<div class="cell markdown" id="tIiCRwqZ54_C">
<ul>
<li>Observations</li>
<li>Sanity checks</li>
</ul>
</div>
<div class="cell code" data-execution_count="280" id="01hJQ7EfMKtK">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ccchurn_ds.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="280">
<pre><code>(10127, 21)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Observation - This dataset has about 10127 rows and 21 columns</p>
</div>
<div class="cell code" data-execution_count="281">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create copy of data set, so that we have a copy of original while we slice and dice the data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy <span class="op">=</span> ccchurn_ds.copy()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="282">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.head(<span class="dv">3</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="282">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CLIENTNUM</th>
      <th>Attrition_Flag</th>
      <th>Customer_Age</th>
      <th>Gender</th>
      <th>Dependent_count</th>
      <th>Education_Level</th>
      <th>Marital_Status</th>
      <th>Income_Category</th>
      <th>Card_Category</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>768805383</td>
      <td>Existing Customer</td>
      <td>45</td>
      <td>M</td>
      <td>3</td>
      <td>High School</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
      <td>39</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>12691.000</td>
      <td>777</td>
      <td>11914.000</td>
      <td>1.335</td>
      <td>1144</td>
      <td>42</td>
      <td>1.625</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>818770008</td>
      <td>Existing Customer</td>
      <td>49</td>
      <td>F</td>
      <td>5</td>
      <td>Graduate</td>
      <td>Single</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>44</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>8256.000</td>
      <td>864</td>
      <td>7392.000</td>
      <td>1.541</td>
      <td>1291</td>
      <td>33</td>
      <td>3.714</td>
      <td>0.105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>713982108</td>
      <td>Existing Customer</td>
      <td>51</td>
      <td>M</td>
      <td>3</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>$80K - $120K</td>
      <td>Blue</td>
      <td>36</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>3418.000</td>
      <td>0</td>
      <td>3418.000</td>
      <td>2.594</td>
      <td>1887</td>
      <td>20</td>
      <td>2.333</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="283">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.tail(<span class="dv">3</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="283">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CLIENTNUM</th>
      <th>Attrition_Flag</th>
      <th>Customer_Age</th>
      <th>Gender</th>
      <th>Dependent_count</th>
      <th>Education_Level</th>
      <th>Marital_Status</th>
      <th>Income_Category</th>
      <th>Card_Category</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10124</th>
      <td>716506083</td>
      <td>Attrited Customer</td>
      <td>44</td>
      <td>F</td>
      <td>1</td>
      <td>High School</td>
      <td>Married</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>36</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>5409.000</td>
      <td>0</td>
      <td>5409.000</td>
      <td>0.819</td>
      <td>10291</td>
      <td>60</td>
      <td>0.818</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>10125</th>
      <td>717406983</td>
      <td>Attrited Customer</td>
      <td>30</td>
      <td>M</td>
      <td>2</td>
      <td>Graduate</td>
      <td>NaN</td>
      <td>$40K - $60K</td>
      <td>Blue</td>
      <td>36</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>5281.000</td>
      <td>0</td>
      <td>5281.000</td>
      <td>0.535</td>
      <td>8395</td>
      <td>62</td>
      <td>0.722</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>10126</th>
      <td>714337233</td>
      <td>Attrited Customer</td>
      <td>43</td>
      <td>F</td>
      <td>2</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>Less than $40K</td>
      <td>Silver</td>
      <td>25</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>10388.000</td>
      <td>1961</td>
      <td>8427.000</td>
      <td>0.703</td>
      <td>10294</td>
      <td>61</td>
      <td>0.649</td>
      <td>0.189</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="284">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10127 entries, 0 to 10126
Data columns (total 21 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   CLIENTNUM                 10127 non-null  int64  
 1   Attrition_Flag            10127 non-null  object 
 2   Customer_Age              10127 non-null  int64  
 3   Gender                    10127 non-null  object 
 4   Dependent_count           10127 non-null  int64  
 5   Education_Level           8608 non-null   object 
 6   Marital_Status            9378 non-null   object 
 7   Income_Category           10127 non-null  object 
 8   Card_Category             10127 non-null  object 
 9   Months_on_book            10127 non-null  int64  
 10  Total_Relationship_Count  10127 non-null  int64  
 11  Months_Inactive_12_mon    10127 non-null  int64  
 12  Contacts_Count_12_mon     10127 non-null  int64  
 13  Credit_Limit              10127 non-null  float64
 14  Total_Revolving_Bal       10127 non-null  int64  
 15  Avg_Open_To_Buy           10127 non-null  float64
 16  Total_Amt_Chng_Q4_Q1      10127 non-null  float64
 17  Total_Trans_Amt           10127 non-null  int64  
 18  Total_Trans_Ct            10127 non-null  int64  
 19  Total_Ct_Chng_Q4_Q1       10127 non-null  float64
 20  Avg_Utilization_Ratio     10127 non-null  float64
dtypes: float64(5), int64(10), object(6)
memory usage: 1.6+ MB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Observations: 15 variables are numerical(int64 &amp; float64) and 6
variables are of object tive. 2 columns have missing values.</p>
</div>
<div class="cell code" data-execution_count="285">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicate values in the data</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="285">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Observation - No duplicate date is found!</p>
</div>
<div class="cell code" data-execution_count="286">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s check for missing values in the data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">round</span>(cc_churn_copy.isnull().<span class="bu">sum</span>() <span class="op">/</span> cc_churn_copy.isnull().count() <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="286">
<pre><code>CLIENTNUM                   0.000
Attrition_Flag              0.000
Customer_Age                0.000
Gender                      0.000
Dependent_count             0.000
Education_Level            15.000
Marital_Status              7.400
Income_Category             0.000
Card_Category               0.000
Months_on_book              0.000
Total_Relationship_Count    0.000
Months_Inactive_12_mon      0.000
Contacts_Count_12_mon       0.000
Credit_Limit                0.000
Total_Revolving_Bal         0.000
Avg_Open_To_Buy             0.000
Total_Amt_Chng_Q4_Q1        0.000
Total_Trans_Amt             0.000
Total_Trans_Ct              0.000
Total_Ct_Chng_Q4_Q1         0.000
Avg_Utilization_Ratio       0.000
dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Observations</p>
<ol>
<li>15% of Educational level data is missing in the data set</li>
<li>7.4% of maritial status is missing!</li>
</ol>
</div>
<div class="cell code" data-execution_count="287">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical summary of the numerical columns in the data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.describe().T</span></code></pre></div>
<div class="output execute_result" data-execution_count="287">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CLIENTNUM</th>
      <td>10127.000</td>
      <td>739177606.334</td>
      <td>36903783.450</td>
      <td>708082083.000</td>
      <td>713036770.500</td>
      <td>717926358.000</td>
      <td>773143533.000</td>
      <td>828343083.000</td>
    </tr>
    <tr>
      <th>Customer_Age</th>
      <td>10127.000</td>
      <td>46.326</td>
      <td>8.017</td>
      <td>26.000</td>
      <td>41.000</td>
      <td>46.000</td>
      <td>52.000</td>
      <td>73.000</td>
    </tr>
    <tr>
      <th>Dependent_count</th>
      <td>10127.000</td>
      <td>2.346</td>
      <td>1.299</td>
      <td>0.000</td>
      <td>1.000</td>
      <td>2.000</td>
      <td>3.000</td>
      <td>5.000</td>
    </tr>
    <tr>
      <th>Months_on_book</th>
      <td>10127.000</td>
      <td>35.928</td>
      <td>7.986</td>
      <td>13.000</td>
      <td>31.000</td>
      <td>36.000</td>
      <td>40.000</td>
      <td>56.000</td>
    </tr>
    <tr>
      <th>Total_Relationship_Count</th>
      <td>10127.000</td>
      <td>3.813</td>
      <td>1.554</td>
      <td>1.000</td>
      <td>3.000</td>
      <td>4.000</td>
      <td>5.000</td>
      <td>6.000</td>
    </tr>
    <tr>
      <th>Months_Inactive_12_mon</th>
      <td>10127.000</td>
      <td>2.341</td>
      <td>1.011</td>
      <td>0.000</td>
      <td>2.000</td>
      <td>2.000</td>
      <td>3.000</td>
      <td>6.000</td>
    </tr>
    <tr>
      <th>Contacts_Count_12_mon</th>
      <td>10127.000</td>
      <td>2.455</td>
      <td>1.106</td>
      <td>0.000</td>
      <td>2.000</td>
      <td>2.000</td>
      <td>3.000</td>
      <td>6.000</td>
    </tr>
    <tr>
      <th>Credit_Limit</th>
      <td>10127.000</td>
      <td>8631.954</td>
      <td>9088.777</td>
      <td>1438.300</td>
      <td>2555.000</td>
      <td>4549.000</td>
      <td>11067.500</td>
      <td>34516.000</td>
    </tr>
    <tr>
      <th>Total_Revolving_Bal</th>
      <td>10127.000</td>
      <td>1162.814</td>
      <td>814.987</td>
      <td>0.000</td>
      <td>359.000</td>
      <td>1276.000</td>
      <td>1784.000</td>
      <td>2517.000</td>
    </tr>
    <tr>
      <th>Avg_Open_To_Buy</th>
      <td>10127.000</td>
      <td>7469.140</td>
      <td>9090.685</td>
      <td>3.000</td>
      <td>1324.500</td>
      <td>3474.000</td>
      <td>9859.000</td>
      <td>34516.000</td>
    </tr>
    <tr>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <td>10127.000</td>
      <td>0.760</td>
      <td>0.219</td>
      <td>0.000</td>
      <td>0.631</td>
      <td>0.736</td>
      <td>0.859</td>
      <td>3.397</td>
    </tr>
    <tr>
      <th>Total_Trans_Amt</th>
      <td>10127.000</td>
      <td>4404.086</td>
      <td>3397.129</td>
      <td>510.000</td>
      <td>2155.500</td>
      <td>3899.000</td>
      <td>4741.000</td>
      <td>18484.000</td>
    </tr>
    <tr>
      <th>Total_Trans_Ct</th>
      <td>10127.000</td>
      <td>64.859</td>
      <td>23.473</td>
      <td>10.000</td>
      <td>45.000</td>
      <td>67.000</td>
      <td>81.000</td>
      <td>139.000</td>
    </tr>
    <tr>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <td>10127.000</td>
      <td>0.712</td>
      <td>0.238</td>
      <td>0.000</td>
      <td>0.582</td>
      <td>0.702</td>
      <td>0.818</td>
      <td>3.714</td>
    </tr>
    <tr>
      <th>Avg_Utilization_Ratio</th>
      <td>10127.000</td>
      <td>0.275</td>
      <td>0.276</td>
      <td>0.000</td>
      <td>0.023</td>
      <td>0.176</td>
      <td>0.503</td>
      <td>0.999</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Observations</p>
<ol>
<li>Clientum is just an unique identifier. There is no value and we can
remove this column.</li>
<li>Total_Revolving_Bal - The average account balance is $1162.81 with a
standard deviation of $814.99. This indicates that there is a spread of
account balances around the mean, with some accounts having much higher
or lower balances than the average.</li>
<li>The average number of transactions per account (Total_Trans_Ct) is
64.86, with a standard deviation of 23.47. This indicates that there is
a variation in the number of transactions across accounts.</li>
</ol>
</div>
<div class="cell code" data-execution_count="288">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.describe(include<span class="op">=</span>[<span class="st">&quot;object&quot;</span>]).T</span></code></pre></div>
<div class="output execute_result" data-execution_count="288">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Attrition_Flag</th>
      <td>10127</td>
      <td>2</td>
      <td>Existing Customer</td>
      <td>8500</td>
    </tr>
    <tr>
      <th>Gender</th>
      <td>10127</td>
      <td>2</td>
      <td>F</td>
      <td>5358</td>
    </tr>
    <tr>
      <th>Education_Level</th>
      <td>8608</td>
      <td>6</td>
      <td>Graduate</td>
      <td>3128</td>
    </tr>
    <tr>
      <th>Marital_Status</th>
      <td>9378</td>
      <td>3</td>
      <td>Married</td>
      <td>4687</td>
    </tr>
    <tr>
      <th>Income_Category</th>
      <td>10127</td>
      <td>6</td>
      <td>Less than $40K</td>
      <td>3561</td>
    </tr>
    <tr>
      <th>Card_Category</th>
      <td>10127</td>
      <td>4</td>
      <td>Blue</td>
      <td>9436</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="289">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cc_churn_copy[<span class="st">&quot;Education_Level&quot;</span>].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Graduate         3128
High School      2013
Uneducated       1487
College          1013
Post-Graduate     516
Doctorate         451
Name: Education_Level, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="290">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cc_churn_copy[<span class="st">&quot;Marital_Status&quot;</span>].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Married     4687
Single      3943
Divorced     748
Name: Marital_Status, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="291">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cc_churn_copy[<span class="st">&quot;Card_Category&quot;</span>].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Blue        9436
Silver       555
Gold         116
Platinum      20
Name: Card_Category, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="292">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cc_churn_copy[<span class="st">&quot;Gender&quot;</span>].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>F    5358
M    4769
Name: Gender, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="293">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing ID, since it is of no use</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.drop([<span class="st">&quot;CLIENTNUM&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="294">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Encoding Existing and Attrited customers to 0 and 1 respectively, for analysis.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Attrition_Flag&quot;</span>].replace(<span class="st">&quot;Existing Customer&quot;</span>, <span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="295">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Attrition_Flag&quot;</span>].replace(<span class="st">&quot;Attrited Customer&quot;</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="296">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy</span></code></pre></div>
<div class="output execute_result" data-execution_count="296">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attrition_Flag</th>
      <th>Customer_Age</th>
      <th>Gender</th>
      <th>Dependent_count</th>
      <th>Education_Level</th>
      <th>Marital_Status</th>
      <th>Income_Category</th>
      <th>Card_Category</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>45</td>
      <td>M</td>
      <td>3</td>
      <td>High School</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
      <td>39</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>12691.000</td>
      <td>777</td>
      <td>11914.000</td>
      <td>1.335</td>
      <td>1144</td>
      <td>42</td>
      <td>1.625</td>
      <td>0.061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>49</td>
      <td>F</td>
      <td>5</td>
      <td>Graduate</td>
      <td>Single</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>44</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>8256.000</td>
      <td>864</td>
      <td>7392.000</td>
      <td>1.541</td>
      <td>1291</td>
      <td>33</td>
      <td>3.714</td>
      <td>0.105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>51</td>
      <td>M</td>
      <td>3</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>$80K - $120K</td>
      <td>Blue</td>
      <td>36</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>3418.000</td>
      <td>0</td>
      <td>3418.000</td>
      <td>2.594</td>
      <td>1887</td>
      <td>20</td>
      <td>2.333</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>40</td>
      <td>F</td>
      <td>4</td>
      <td>High School</td>
      <td>NaN</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>34</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>3313.000</td>
      <td>2517</td>
      <td>796.000</td>
      <td>1.405</td>
      <td>1171</td>
      <td>20</td>
      <td>2.333</td>
      <td>0.760</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>40</td>
      <td>M</td>
      <td>3</td>
      <td>Uneducated</td>
      <td>Married</td>
      <td>$60K - $80K</td>
      <td>Blue</td>
      <td>21</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>4716.000</td>
      <td>0</td>
      <td>4716.000</td>
      <td>2.175</td>
      <td>816</td>
      <td>28</td>
      <td>2.500</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10122</th>
      <td>0</td>
      <td>50</td>
      <td>M</td>
      <td>2</td>
      <td>Graduate</td>
      <td>Single</td>
      <td>$40K - $60K</td>
      <td>Blue</td>
      <td>40</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4003.000</td>
      <td>1851</td>
      <td>2152.000</td>
      <td>0.703</td>
      <td>15476</td>
      <td>117</td>
      <td>0.857</td>
      <td>0.462</td>
    </tr>
    <tr>
      <th>10123</th>
      <td>1</td>
      <td>41</td>
      <td>M</td>
      <td>2</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>$40K - $60K</td>
      <td>Blue</td>
      <td>25</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>4277.000</td>
      <td>2186</td>
      <td>2091.000</td>
      <td>0.804</td>
      <td>8764</td>
      <td>69</td>
      <td>0.683</td>
      <td>0.511</td>
    </tr>
    <tr>
      <th>10124</th>
      <td>1</td>
      <td>44</td>
      <td>F</td>
      <td>1</td>
      <td>High School</td>
      <td>Married</td>
      <td>Less than $40K</td>
      <td>Blue</td>
      <td>36</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>5409.000</td>
      <td>0</td>
      <td>5409.000</td>
      <td>0.819</td>
      <td>10291</td>
      <td>60</td>
      <td>0.818</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>10125</th>
      <td>1</td>
      <td>30</td>
      <td>M</td>
      <td>2</td>
      <td>Graduate</td>
      <td>NaN</td>
      <td>$40K - $60K</td>
      <td>Blue</td>
      <td>36</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>5281.000</td>
      <td>0</td>
      <td>5281.000</td>
      <td>0.535</td>
      <td>8395</td>
      <td>62</td>
      <td>0.722</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>10126</th>
      <td>1</td>
      <td>43</td>
      <td>F</td>
      <td>2</td>
      <td>Graduate</td>
      <td>Married</td>
      <td>Less than $40K</td>
      <td>Silver</td>
      <td>25</td>
      <td>6</td>
      <td>2</td>
      <td>4</td>
      <td>10388.000</td>
      <td>1961</td>
      <td>8427.000</td>
      <td>0.703</td>
      <td>10294</td>
      <td>61</td>
      <td>0.649</td>
      <td>0.189</td>
    </tr>
  </tbody>
</table>
<p>10127 rows × 20 columns</p>
</div>
</div>
</div>
<section id="exploratory-data-analysis-eda" class="cell markdown"
id="j-yGG8LNSSMa">
<h2>Exploratory Data Analysis (EDA)</h2>
</section>
<div class="cell markdown" id="3bGVKmh75ri8">
<ul>
<li>EDA is an important part of any project involving data.</li>
<li>It is important to investigate and understand the data better before
building a model with it.</li>
<li>A few questions have been mentioned below which will help you
approach the analysis in the right manner and generate insights from the
data.</li>
<li>A thorough analysis of the data, in addition to the questions
mentioned below, should be done.</li>
</ul>
</div>
<div class="cell markdown" id="oEyqzdJBb0jU">
<p><strong>Questions</strong>:</p>
<ol>
<li>How is the total transaction amount distributed?</li>
<li>What is the distribution of the level of education of
customers?</li>
<li>What is the distribution of the level of income of customers?</li>
<li>How does the change in transaction amount between Q4 and Q1
(<code>total_ct_change_Q4_Q1</code>) vary by the customer's account
status (<code>Attrition_Flag</code>)?</li>
<li>How does the number of months a customer was inactive in the last 12
months (<code>Months_Inactive_12_mon</code>) vary by the customer's
account status (<code>Attrition_Flag</code>)?</li>
<li>What are the attributes that have a strong correlation with each
other?</li>
</ol>
</div>
<section
id="the-below-functions-need-to-be-defined-to-carry-out-the-exploratory-data-analysis"
class="cell markdown" id="-YyWJgFlKlWM">
<h4>The below functions need to be defined to carry out the Exploratory
Data Analysis.</h4>
</section>
<div class="cell code" data-execution_count="297" id="QIP4bI3Zbp07">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot a boxplot and a histogram along the same scale.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> histogram_boxplot(data, feature, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>), kde<span class="op">=</span><span class="va">False</span>, bins<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Boxplot and histogram combined</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    data: dataframe</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">    feature: dataframe column</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">    figsize: size of figure (default (12,7))</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">    kde: whether to the show density curve (default False)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">    bins: number of bins for histogram (default None)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    f2, (ax_box2, ax_hist2) <span class="op">=</span> plt.subplots(</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        nrows<span class="op">=</span><span class="dv">2</span>,  <span class="co"># Number of rows of the subplot grid= 2</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        sharex<span class="op">=</span><span class="va">True</span>,  <span class="co"># x-axis will be shared among all subplots</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        gridspec_kw<span class="op">=</span>{<span class="st">&quot;height_ratios&quot;</span>: (<span class="fl">0.25</span>, <span class="fl">0.75</span>)},</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        figsize<span class="op">=</span>figsize,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># creating the 2 subplots</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data, x<span class="op">=</span>feature, ax<span class="op">=</span>ax_box2, showmeans<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&quot;violet&quot;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># boxplot will be created and a triangle will indicate the mean value of the column</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    sns.histplot(</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data, x<span class="op">=</span>feature, kde<span class="op">=</span>kde, ax<span class="op">=</span>ax_hist2, bins<span class="op">=</span>bins, palette<span class="op">=</span><span class="st">&quot;winter&quot;</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="cf">if</span> bins <span class="cf">else</span> sns.histplot(</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data, x<span class="op">=</span>feature, kde<span class="op">=</span>kde, ax<span class="op">=</span>ax_hist2</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># For histogram</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    ax_hist2.axvline(</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        data[feature].mean(), color<span class="op">=</span><span class="st">&quot;green&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Add mean to the histogram</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    ax_hist2.axvline(</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        data[feature].median(), color<span class="op">=</span><span class="st">&quot;black&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;-&quot;</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Add median to the histogram</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="298" id="5021de33">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to create labeled barplots</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> labeled_barplot(data, feature, perc<span class="op">=</span><span class="va">False</span>, n<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Barplot with percentage at the top</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">    data: dataframe</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">    feature: dataframe column</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">    perc: whether to display percentages instead of count (default is False)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">    n: displays the top n category levels (default is None, i.e., display all levels)</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="bu">len</span>(data[feature])  <span class="co"># length of the column</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> data[feature].nunique()</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(count <span class="op">+</span> <span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(n <span class="op">+</span> <span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> sns.countplot(</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>feature,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">&quot;Paired&quot;</span>,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        order<span class="op">=</span>data[feature].value_counts().index[:n].sort_values(),</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> perc <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>            label <span class="op">=</span> <span class="st">&quot;</span><span class="sc">{:.1f}</span><span class="st">%&quot;</span>.<span class="bu">format</span>(</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>                <span class="dv">100</span> <span class="op">*</span> p.get_height() <span class="op">/</span> total</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>            )  <span class="co"># percentage of each class of the category</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>            label <span class="op">=</span> p.get_height()  <span class="co"># count of each level of the category</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="dv">2</span>  <span class="co"># width of the plot</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> p.get_height()  <span class="co"># height of the plot</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>        ax.annotate(</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>            label,</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>            (x, y),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            ha<span class="op">=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">&quot;center&quot;</span>,</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>            textcoords<span class="op">=</span><span class="st">&quot;offset points&quot;</span>,</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>        )  <span class="co"># annotate the percentage</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>    plt.show()  <span class="co"># show the plot</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="299" id="c08fe5b8">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot stacked bar chart</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stacked_barplot(data, predictor, target):</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Print the category counts and plot a stacked bar chart</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">    data: dataframe</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">    predictor: independent variable</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">    target: target variable</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> data[predictor].nunique()</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    sorter <span class="op">=</span> data[target].value_counts().index[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    tab1 <span class="op">=</span> pd.crosstab(data[predictor], data[target], margins<span class="op">=</span><span class="va">True</span>).sort_values(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        by<span class="op">=</span>sorter, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(tab1)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-&quot;</span> <span class="op">*</span> <span class="dv">120</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    tab <span class="op">=</span> pd.crosstab(data[predictor], data[target], normalize<span class="op">=</span><span class="st">&quot;index&quot;</span>).sort_values(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        by<span class="op">=</span>sorter, ascending<span class="op">=</span><span class="va">False</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    tab.plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>, stacked<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(count <span class="op">+</span> <span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    plt.legend(</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">&quot;lower left&quot;</span>, frameon<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">&quot;upper left&quot;</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="300" id="e90985c5">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Function to plot distributions</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distribution_plot_wrt_target(data, predictor, target):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    target_uniq <span class="op">=</span> data[target].unique()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">&quot;Distribution of target for target=&quot;</span> <span class="op">+</span> <span class="bu">str</span>(target_uniq[<span class="dv">0</span>]))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    sns.histplot(</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data[data[target] <span class="op">==</span> target_uniq[<span class="dv">0</span>]],</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>predictor,</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        kde<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axs[<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">&quot;teal&quot;</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">&quot;Distribution of target for target=&quot;</span> <span class="op">+</span> <span class="bu">str</span>(target_uniq[<span class="dv">1</span>]))</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    sns.histplot(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data[data[target] <span class="op">==</span> target_uniq[<span class="dv">1</span>]],</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>predictor,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        kde<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axs[<span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">&quot;orange&quot;</span>,</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">&quot;Boxplot w.r.t target&quot;</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(data<span class="op">=</span>data, x<span class="op">=</span>target, y<span class="op">=</span>predictor, ax<span class="op">=</span>axs[<span class="dv">1</span>, <span class="dv">0</span>], palette<span class="op">=</span><span class="st">&quot;gist_rainbow&quot;</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">&quot;Boxplot (without outliers) w.r.t target&quot;</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>target,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>predictor,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axs[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>        showfliers<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>        palette<span class="op">=</span><span class="st">&quot;gist_rainbow&quot;</span>,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="301">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&quot;Customer_Age&quot;</span>, kde<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/eff6cb1f3eb8cb743b34b86e776496be181d8adc.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="302">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Months_on_book&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/64346ed839ae40c5a032b534925bc0508878aa00.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="303">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Credit_Limit&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/a3123b1c7d177b897c03693bb37ee4896ed85de8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="304">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Total_Revolving_Bal&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/e38675eae50afea9b59f4c4a3619c55e80ba481f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="305">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Avg_Open_To_Buy&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/f99ff390a94edf861f48abe7423b1d83c11e4bc9.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="306">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Total_Trans_Ct&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/18081f400585febd1aa16920379585ed6ec55d9a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="307">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Total_Amt_Chng_Q4_Q1&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/c2bdbd37c3eec2e9a3ffae8e45a12a0d1b863450.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="308">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Total_Trans_Amt&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/5ebc2170d7d7dd67b52972af24973835a7e59987.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>How is the total transaction amount distributed?</p>
<p>The distribution of total transaction amount is right skewed, meaning
that most customers have lower transaction amounts, with a smaller
number of customers having very high transaction amounts. There are also
high amount of outliers</p>
</div>
<div class="cell code" data-execution_count="309">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Total_Ct_Chng_Q4_Q1&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/2a3de65b253cd373ae87409f7ce7cfdf213b9748.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="310">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>histogram_boxplot(cc_churn_copy, <span class="st">&#39;Avg_Utilization_Ratio&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/68cde141ef90e2f19806f38ee310b947fdcddbfb.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="311">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Dependent_count&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/2d259ce369ddfc7cc0d2daf4e63140ebbbf42159.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="312">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Education_Level&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/81b36af1a246f32d021d4b8a66cb93fbb7ed921d.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>What is the distribution of the level of education of customers?</p>
<p>The distribution of education levels among customers is uneven. The
majority of customers have a Graduate degree (3128), followed by those
with a High School diploma (2013).The smallest groups are those with
Doctorate (451) and Post-Graduate degrees (516).</p>
</div>
<div class="cell code" data-execution_count="313">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Marital_Status&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/7d8c37a13d83350caadbdcd292cd6a2f98148537.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Observation: Nearly even split between Married and Single . Very few
are divorsed</p>
</div>
<div class="cell code" data-execution_count="314">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Income_Category&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/1348ead28c78ce8f5dcd36322f59b2526c2be47e.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>What is the distribution of the level of income of customers?</p>
<p>The distribution of income levels among customers is uneven, with the
majority of customers (3561) earning less than $40k.</p>
</div>
<div class="cell code" data-execution_count="315">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Total_Relationship_Count&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/fcb08242f494d3a7ce7fc92fe6d1e8bae7eb7406.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Observation :Most customers have more than 2 relationshops</p>
</div>
<div class="cell code" data-execution_count="316">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Months_Inactive_12_mon&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/6b3ec69631a46d1c86c1e004fb4edc823ce8a0f0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="317">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Contacts_Count_12_mon&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/0f98a5932436b09230ee9000080b3d6691b3c4f1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="318">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Gender&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/81a4876513cb73e9a04b5b6b1d2c51256502347a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="319">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Card_Category&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/1ec06ceda4e215cd6b17b7211b7c3b6d7a5371e0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="320">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>labeled_barplot(cc_churn_copy, <span class="st">&quot;Attrition_Flag&quot;</span>) </span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/831f5c7f14493ba6b225ac9b3e36be74bfd27524.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="321">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating histograms</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.hist(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">14</span>))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/640f7ad1d797e96c58647def2391a2fb1c371f56.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="322">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">7</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cc_churn_copy.corr(), annot<span class="op">=</span><span class="va">True</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, cmap<span class="op">=</span><span class="st">&quot;Spectral&quot;</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/f9480aab2611283fa78b77fb83f52365c509fdb4.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>What are the attributes that have a strong correlation with each
other?</p>
<p>Total_Trans_Amt and Total_Trans_Ct: These have a very high
correlation of 0.81, indicating that customers who make a higher number
of transactions also tend to have higher transaction amounts. This is
quite intuitive, as more transactions naturally lead to higher total
spending.</p>
<p>Total_Trans_Ct and Total_Ct_Chng_Q4_Q1: These have a correlation of
0.11, suggesting a moderate positive relationship between the total
number of transactions and the change in transaction count between Q4
and Q1. This means that customers with more transactions might also be
showing some increase in their transaction behavior over time.</p>
<p>Avg_Utilization_Ratio and Total_Revolving_Bal: There's a strong
positive correlation of 0.62 between these two. This makes sense because
the utilization ratio is calculated by dividing the revolving balance by
the credit limit. So, the higher the revolving balance, the higher the
utilization ratio, given a fixed credit limit.</p>
<p>Avg_Utilization_Ratio and Credit_Limit: There's a strong negative
correlation of -0.48 between the average utilization ratio and the
credit limit. This indicates that customers with higher credit limits
tend to use a smaller proportion of their available credit.</p>
<p>Customer_Age and Months_on_book: These show a moderately high
correlation of 0.79, suggesting that older customers tend to have been
with the bank for a longer duration. This is expected as they've had
more time to accumulate months on their account.</p>
</div>
<div class="cell code" data-execution_count="323">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Gender&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag     0     1    All
Gender                           
All             8500  1627  10127
F               4428   930   5358
M               4072   697   4769
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/7f795a51447427884d77073cf4e5a3a305c7c52c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="324">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Marital_Status&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag     0     1   All
Marital_Status                  
All             7880  1498  9378
Married         3978   709  4687
Single          3275   668  3943
Divorced         627   121   748
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/a8caea1bf170bccdc34f59eac8af8379be2bcaa4.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="325">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Education_Level&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag      0     1   All
Education_Level                  
All              7237  1371  8608
Graduate         2641   487  3128
High School      1707   306  2013
Uneducated       1250   237  1487
College           859   154  1013
Doctorate         356    95   451
Post-Graduate     424    92   516
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/d0007ba08bb875f1634a4fc630e43af919635191.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="326">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Income_Category&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag      0     1    All
Income_Category                   
All              8500  1627  10127
Less than $40K   2949   612   3561
$40K - $60K      1519   271   1790
$80K - $120K     1293   242   1535
$60K - $80K      1213   189   1402
abc               925   187   1112
$120K +           601   126    727
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/c9de56e89ecc3406bc3133d55c3813be99016f0c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="327">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Contacts_Count_12_mon&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag            0     1    All
Contacts_Count_12_mon                   
All                    8500  1627  10127
3                      2699   681   3380
2                      2824   403   3227
4                      1077   315   1392
1                      1391   108   1499
5                       117    59    176
6                         0    54     54
0                       392     7    399
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/4c70779f1cc3b5ce9700adf9753d519ca59e13bc.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="328">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Total_Relationship_Count&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag               0     1    All
Total_Relationship_Count                   
All                       8500  1627  10127
3                         1905   400   2305
2                          897   346   1243
1                          677   233    910
5                         1664   227   1891
4                         1687   225   1912
6                         1670   196   1866
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/84388558c8e9c280fede3c1af5654d85d8f6a95c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="329">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Dependent_count&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag      0     1    All
Dependent_count                   
All              8500  1627  10127
3                2250   482   2732
2                2238   417   2655
1                1569   269   1838
4                1314   260   1574
0                 769   135    904
5                 360    64    424
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/d010962e8338b78302cca607f75608a9a17ba9ac.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="330">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>stacked_barplot(cc_churn_copy, <span class="st">&quot;Months_Inactive_12_mon&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Attrition_Flag             0     1    All
Months_Inactive_12_mon                   
All                     8500  1627  10127
3                       3020   826   3846
2                       2777   505   3282
4                        305   130    435
1                       2133   100   2233
5                        146    32    178
6                        105    19    124
0                         14    15     29
------------------------------------------------------------------------------------------------------------------------
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/2d354ffb91b312223feec5038f31adabb11933e2.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="331">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Total_Revolving_Bal&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/5c766d65ed0067a4001d303433b43010bff4b8c3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="332">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Credit_Limit&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/c36aaafca652ee9197cdd451e8774520fdc6c45e.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="333">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Customer_Age&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/29e0d866575ef910350f318452975e01ea5e0124.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="334">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Total_Trans_Ct&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/8e64e1dcdabb76d7c87f4370457ba06478e82757.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="335">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Total_Trans_Amt&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/a25cf1d8fdb1fbdd3e6a6b783d7ee514ea75f3af.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="336">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Total_Ct_Chng_Q4_Q1&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/9e46ed9752e88ba6d334e9fb190740fa4f2e4ab9.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>How does the change in transaction amount between Q4 and Q1
(<code>total_ct_change_Q4_Q1</code>) vary by the customer's account
status (<code>Attrition_Flag</code>)?</p>
<p>Based on the heat map, There is negative correlation between
total_ct_change_q4_q1 and attrition flag. Which means decrease in
transaction over the quarters have led to increase in attrition.</p>
</div>
<div class="cell code" data-execution_count="337">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Avg_Utilization_Ratio&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/5c3343148ea5c3371548ac5d211578a7b2716729.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="338">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Months_on_book&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/8b0a952da93c12baab20d1c6a8f671b5ca03c80f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="339">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Total_Revolving_Bal&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/5c766d65ed0067a4001d303433b43010bff4b8c3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="340">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Avg_Open_To_Buy&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/d11140da4374aec01c3410e15f291e38befa8e0a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="341">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>distribution_plot_wrt_target(cc_churn_copy, <span class="st">&quot;Months_Inactive_12_mon&quot;</span>, <span class="st">&quot;Attrition_Flag&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/44895d379cec3152bc0cb53b821058d9e86ae3ce.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>How does the number of months a customer was inactive in the last 12
months (<code>Months_Inactive_12_mon</code>) vary by the customer's
account status (<code>Attrition_Flag</code>)?</p>
<p>Existing Customers: The distribution is heavily skewed to the left,
with a majority of customers having 0-2 months of inactivity. This
suggests that most existing customers actively use their accounts.</p>
<p>Attrited Customers: The distribution shifts slightly to the right,
with a higher proportion of customers having 2-4 months of inactivity
compared to existing customers. This indicates that attrited customers
were generally less active before leaving.</p>
<p>Based on the data set, it seems customers who were inactive for
longer periods have high tendency to be be attrited.</p>
</div>
<section id="data-pre-processing" class="cell markdown"
id="knk0w9XH4jao">
<h2>Data Pre-processing</h2>
</section>
<div class="cell code" data-execution_count="342" id="2JbJc1bX4jao">
<div class="sourceCode" id="cb83"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="op">=</span> cc_churn_copy.quantile(<span class="fl">0.25</span>)  <span class="co"># To find the 25th percentile</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="op">=</span> cc_churn_copy.quantile(<span class="fl">0.75</span>)  <span class="co"># To find the 75th percentile</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1  <span class="co"># Inter Quantile Range (75th perentile - 25th percentile)</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Finding lower and upper bounds for all values. All values outside these bounds are outliers</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>lower <span class="op">=</span> (Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>upper <span class="op">=</span> (Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="343">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checking the % outliers</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>((data.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;float64&quot;</span>, <span class="st">&quot;int64&quot;</span>]) <span class="op">&lt;</span> lower) <span class="op">|</span> (cc_churn_copy.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;float64&quot;</span>, <span class="st">&quot;int64&quot;</span>]) <span class="op">&gt;</span> upper)).<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(cc_churn_copy) <span class="op">*</span> <span class="dv">100</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="343">
<pre><code>Attrition_Flag             16.066
Avg_Open_To_Buy             9.509
Avg_Utilization_Ratio       0.000
CLIENTNUM                   0.000
Contacts_Count_12_mon       6.211
Credit_Limit                9.717
Customer_Age                0.020
Dependent_count             0.000
Months_Inactive_12_mon      3.268
Months_on_book              3.812
Total_Amt_Chng_Q4_Q1        3.910
Total_Ct_Chng_Q4_Q1         3.891
Total_Relationship_Count    0.000
Total_Revolving_Bal         0.000
Total_Trans_Amt             8.848
Total_Trans_Ct              0.020
dtype: float64</code></pre>
</div>
</div>
<section id="missing-value" class="cell markdown" id="0J99-7Kubp09">
<h2>Missing value</h2>
</section>
<div class="cell code" data-execution_count="344">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Missing values for Integer</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="344">
<pre><code>Attrition_Flag                 0
Customer_Age                   0
Gender                         0
Dependent_count                0
Education_Level             1519
Marital_Status               749
Income_Category                0
Card_Category                  0
Months_on_book                 0
Total_Relationship_Count       0
Months_Inactive_12_mon         0
Contacts_Count_12_mon          0
Credit_Limit                   0
Total_Revolving_Bal            0
Avg_Open_To_Buy                0
Total_Amt_Chng_Q4_Q1           0
Total_Trans_Amt                0
Total_Trans_Ct                 0
Total_Ct_Chng_Q4_Q1            0
Avg_Utilization_Ratio          0
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="345">
<div class="sourceCode" id="cb88"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Marital_Status&quot;</span>].value_counts(dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="345">
<pre><code>Married     4687
Single      3943
NaN          749
Divorced     748
Name: Marital_Status, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="346">
<div class="sourceCode" id="cb90"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Education_Level&quot;</span>].value_counts(dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="346">
<pre><code>Graduate         3128
High School      2013
NaN              1519
Uneducated       1487
College          1013
Post-Graduate     516
Doctorate         451
Name: Education_Level, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="347">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Income_Category&quot;</span>].value_counts(dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="347">
<pre><code>Less than $40K    3561
$40K - $60K       1790
$80K - $120K      1535
$60K - $80K       1402
abc               1112
$120K +            727
Name: Income_Category, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="348">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy[<span class="st">&quot;Income_Category&quot;</span>].replace(</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;abc&quot;</span>, np.nan, inplace<span class="op">=</span><span class="va">True</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>)  <span class="co">### complete the code to replace the anomalous values with NaN</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="349">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>cc_churn_copy.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="349">
<pre><code>Attrition_Flag                 0
Customer_Age                   0
Gender                         0
Dependent_count                0
Education_Level             1519
Marital_Status               749
Income_Category             1112
Card_Category                  0
Months_on_book                 0
Total_Relationship_Count       0
Months_Inactive_12_mon         0
Contacts_Count_12_mon          0
Credit_Limit                   0
Total_Revolving_Bal            0
Avg_Open_To_Buy                0
Total_Amt_Chng_Q4_Q1           0
Total_Trans_Amt                0
Total_Trans_Ct                 0
Total_Ct_Chng_Q4_Q1            0
Avg_Utilization_Ratio          0
dtype: int64</code></pre>
</div>
</div>
<section id="missing-value-imputation" class="cell markdown">
<h2>Missing value imputation</h2>
</section>
<div class="cell code" data-execution_count="350">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">&quot;most_frequent&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="351">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate dependent &amp; independent variable</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> cc_churn_copy.drop([<span class="st">&quot;Attrition_Flag&quot;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> cc_churn_copy[<span class="st">&quot;Attrition_Flag&quot;</span>]</span></code></pre></div>
</div>
<section id="train-test-split" class="cell markdown">
<h3>Train-Test Split</h3>
</section>
<div class="cell code" data-execution_count="352">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting data into training and validation set:</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape, X_val.shape, X_train.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(8101, 19) (2026, 19) (8101, 19)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="353">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>reqd_col_for_impute <span class="op">=</span> [<span class="st">&quot;Education_Level&quot;</span>, <span class="st">&quot;Marital_Status&quot;</span>, <span class="st">&quot;Income_Category&quot;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="354">
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit and transform the train data</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>X_train[reqd_col_for_impute] <span class="op">=</span> imputer.fit_transform(X_train[reqd_col_for_impute])</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the validation data</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>X_val[reqd_col_for_impute] <span class="op">=</span> imputer.fit_transform(</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    X_val[reqd_col_for_impute]</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to impute missing values in X_val</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="355">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>X_val.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="355">
<pre><code>Customer_Age                0
Gender                      0
Dependent_count             0
Education_Level             0
Marital_Status              0
Income_Category             0
Card_Category               0
Months_on_book              0
Total_Relationship_Count    0
Months_Inactive_12_mon      0
Contacts_Count_12_mon       0
Credit_Limit                0
Total_Revolving_Bal         0
Avg_Open_To_Buy             0
Total_Amt_Chng_Q4_Q1        0
Total_Trans_Amt             0
Total_Trans_Ct              0
Total_Ct_Chng_Q4_Q1         0
Avg_Utilization_Ratio       0
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="356">
<div class="sourceCode" id="cb105"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> X_train.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;object&quot;</span>, <span class="st">&quot;category&quot;</span>])</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cols.columns:</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(X_train[i].value_counts())</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;*&quot;</span> <span class="op">*</span> <span class="dv">30</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>F    4279
M    3822
Name: Gender, dtype: int64
******************************
Graduate         3733
High School      1619
Uneducated       1171
College           816
Post-Graduate     407
Doctorate         355
Name: Education_Level, dtype: int64
******************************
Married     4346
Single      3144
Divorced     611
Name: Marital_Status, dtype: int64
******************************
Less than $40K    3701
$40K - $60K       1453
$80K - $120K      1237
$60K - $80K       1122
$120K +            588
Name: Income_Category, dtype: int64
******************************
Blue        7557
Silver       436
Gold          93
Platinum      15
Name: Card_Category, dtype: int64
******************************
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="357">
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> pd.get_dummies(X_train, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> pd.get_dummies(</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    X_val, drop_first<span class="op">=</span><span class="va">True</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to impute missing values in X_val</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># X_test = &#39;_______&#39;  ## Complete the code to impute missing values in X_val</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(X_train.shape, X_val.shape, X_test.shape)</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># X_test = &#39;_______&#39;  ## Complete the code to impute missing values in X_val</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape, X_val.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(8101, 29) (2026, 29)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="358">
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>X_train.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="358">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer_Age</th>
      <th>Dependent_count</th>
      <th>Months_on_book</th>
      <th>Total_Relationship_Count</th>
      <th>Months_Inactive_12_mon</th>
      <th>Contacts_Count_12_mon</th>
      <th>Credit_Limit</th>
      <th>Total_Revolving_Bal</th>
      <th>Avg_Open_To_Buy</th>
      <th>Total_Amt_Chng_Q4_Q1</th>
      <th>Total_Trans_Amt</th>
      <th>Total_Trans_Ct</th>
      <th>Total_Ct_Chng_Q4_Q1</th>
      <th>Avg_Utilization_Ratio</th>
      <th>Gender_M</th>
      <th>Education_Level_Doctorate</th>
      <th>Education_Level_Graduate</th>
      <th>Education_Level_High School</th>
      <th>Education_Level_Post-Graduate</th>
      <th>Education_Level_Uneducated</th>
      <th>Marital_Status_Married</th>
      <th>Marital_Status_Single</th>
      <th>Income_Category_$40K - $60K</th>
      <th>Income_Category_$60K - $80K</th>
      <th>Income_Category_$80K - $120K</th>
      <th>Income_Category_Less than $40K</th>
      <th>Card_Category_Gold</th>
      <th>Card_Category_Platinum</th>
      <th>Card_Category_Silver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9066</th>
      <td>54</td>
      <td>1</td>
      <td>36</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>3723.000</td>
      <td>1728</td>
      <td>1995.000</td>
      <td>0.595</td>
      <td>8554</td>
      <td>99</td>
      <td>0.678</td>
      <td>0.464</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5814</th>
      <td>58</td>
      <td>4</td>
      <td>48</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>5396.000</td>
      <td>1803</td>
      <td>3593.000</td>
      <td>0.493</td>
      <td>2107</td>
      <td>39</td>
      <td>0.393</td>
      <td>0.334</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>792</th>
      <td>45</td>
      <td>4</td>
      <td>36</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>15987.000</td>
      <td>1648</td>
      <td>14339.000</td>
      <td>0.732</td>
      <td>1436</td>
      <td>36</td>
      <td>1.250</td>
      <td>0.103</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1791</th>
      <td>34</td>
      <td>2</td>
      <td>36</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3625.000</td>
      <td>2517</td>
      <td>1108.000</td>
      <td>1.158</td>
      <td>2616</td>
      <td>46</td>
      <td>1.300</td>
      <td>0.694</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5011</th>
      <td>49</td>
      <td>2</td>
      <td>39</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>2720.000</td>
      <td>1926</td>
      <td>794.000</td>
      <td>0.602</td>
      <td>3806</td>
      <td>61</td>
      <td>0.794</td>
      <td>0.708</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="model-building" class="cell markdown" id="OzOa9FGA6WtG">
<h2>Model Building</h2>
</section>
<section id="model-evaluation-criterion" class="cell markdown"
id="YZqmoqz7bp0-">
<h3>Model evaluation criterion</h3>
</section>
<div class="cell markdown" id="l2ORUgmUjDZC">
<p>The nature of predictions made by the classification model will
translate as follows:</p>
<ul>
<li>True positives (TP) are failures correctly predicted by the
model.</li>
<li>False negatives (FN) are real failures in a generator where there is
no detection by model.</li>
<li>False positives (FP) are failure detections in a generator where
there is no failure.</li>
</ul>
<p><strong>Which metric to optimize?</strong></p>
<ul>
<li>We need to choose the metric which will ensure that the maximum
number of generator failures are predicted correctly by the model.</li>
<li>We would want Recall to be maximized as greater the Recall, the
higher the chances of minimizing false negatives.</li>
<li>We want to minimize false negatives because if a model predicts that
a machine will have no failure when there will be a failure, it will
increase the maintenance cost.</li>
</ul>
</div>
<div class="cell markdown" id="djQTqGKU4jap">
<p><strong>Let's define a function to output different metrics
(including recall) on the train and test set and a function to show
confusion matrix so that we do not have to use the same code
repetitively while evaluating models.</strong></p>
</div>
<div class="cell code" data-execution_count="359" id="bIekBxwp4jaq">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining a function to compute different metrics to check performance of a classification model built using sklearn</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> model_performance_classification_sklearn(model, predictors, target):</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Function to compute different metrics to check classification model performance</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co">    model: classifier</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co">    predictors: independent variables</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">    target: dependent variable</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># predicting using the independent variables</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> model.predict(predictors)</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(target, pred)  <span class="co"># to compute Accuracy</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    recall <span class="op">=</span> recall_score(target, pred)  <span class="co"># to compute Recall</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> precision_score(target, pred)  <span class="co"># to compute Precision</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(target, pred)  <span class="co"># to compute F1-score</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creating a dataframe of metrics</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    df_perf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Accuracy&quot;</span>: acc,</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Recall&quot;</span>: recall,</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Precision&quot;</span>: precision,</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;F1&quot;</span>: f1</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        index<span class="op">=</span>[<span class="dv">0</span>],</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_perf</span></code></pre></div>
</div>
<section id="model-building-with-original-data" class="cell markdown"
id="eqCDCbcw4jas">
<h3>Model Building with original data</h3>
</section>
<div class="cell markdown" id="dBtuhurlhKyp">
<p>Sample code for model building with original data</p>
</div>
<div class="cell code" data-execution_count="360" id="V-tpzI7g4jas">
<div class="sourceCode" id="cb111"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> []  <span class="co"># Empty list to store all the models</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Appending models into the list</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;Bagging&quot;</span>, BaggingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;Random forest&quot;</span>, RandomForestClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;AdaBoost&quot;</span>, AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;GradientBoost&quot;</span>, GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>models.append((<span class="st">&quot;XGBClassifier&quot;</span>, XGBClassifier(random_state<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="st">&quot;Training Performance:&quot;</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> recall_score(y_train, model.predict(X_train))</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(name, scores))</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="st">&quot;Validation Performance:&quot;</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, model <span class="kw">in</span> models:</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train, y_train)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>    scores_val <span class="op">=</span> recall_score(y_val, model.predict(X_val))</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">{}</span><span class="st">: </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(name, scores_val))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Training Performance:

Bagging: 0.98
Random forest: 1.0
AdaBoost: 0.8707692307692307
GradientBoost: 0.8938461538461538
XGBClassifier: 1.0

Validation Performance:

Bagging: 0.8134556574923547
Random forest: 0.7614678899082569
AdaBoost: 0.8165137614678899
GradientBoost: 0.8409785932721713
XGBClassifier: 0.8776758409785933
</code></pre>
</div>
</div>
<section id="model-building-with-oversampled-data" class="cell markdown"
id="oBKJaFU24jas">
<h3>Model Building with Oversampled data</h3>
</section>
<div class="cell code" data-execution_count="361" id="FKxnygkE4jat">
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.under_sampling <span class="im">import</span> RandomUnderSampler</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="362" id="uYDlbnUO4jat">
<div class="sourceCode" id="cb114"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Synthetic Minority Over Sampling Technique</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>sm <span class="op">=</span> SMOTE(sampling_strategy<span class="op">=</span><span class="dv">1</span>, k_neighbors<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>X_train_over, y_train_over <span class="op">=</span> sm.fit_resample(X_train, y_train)</span></code></pre></div>
</div>
<section id="model-building-with-undersampled-data"
class="cell markdown" id="1aimb6bn4jat">
<h3>Model Building with Undersampled data</h3>
</section>
<div class="cell code" data-execution_count="363" id="DhxfTkvu4jat">
<div class="sourceCode" id="cb115"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random undersampler for under sampling the data</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>rus <span class="op">=</span> RandomUnderSampler(random_state<span class="op">=</span><span class="dv">1</span>, sampling_strategy<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>X_train_un, y_train_un <span class="op">=</span> rus.fit_resample(X_train, y_train)</span></code></pre></div>
</div>
<section id="hyperparametertuning" class="cell markdown"
id="yZGY1eL84jau">
<h3>HyperparameterTuning</h3>
</section>
<section id="sample-parameter-grids" class="cell markdown"
id="rxM3jQuK_Pqc">
<h4>Sample Parameter Grids</h4>
</section>
<div class="cell markdown" id="MSSmdBoHDJwO">
<p><strong>Note</strong></p>
<ol>
<li>Sample parameter grids have been provided to do necessary
hyperparameter tuning. These sample grids are expected to provide a
balance between model performance improvement and execution time. One
can extend/reduce the parameter grid based on execution time and system
configuration.</li>
</ol>
<ul>
<li>Please note that if the parameter grid is extended to improve the
model performance further, the execution time will increase</li>
</ul>
</div>
<div class="cell markdown" id="czq7BZ5b4jau">
<ul>
<li>For Gradient Boosting:</li>
</ul>
<pre><code>param_grid = {
    &quot;init&quot;: [AdaBoostClassifier(random_state=1),DecisionTreeClassifier(random_state=1)],
    &quot;n_estimators&quot;: np.arange(50,110,25),
    &quot;learning_rate&quot;: [0.01,0.1,0.05],
    &quot;subsample&quot;:[0.7,0.9],
    &quot;max_features&quot;:[0.5,0.7,1],
}</code></pre>
<ul>
<li>For Adaboost:</li>
</ul>
<pre><code>param_grid = {
    &quot;n_estimators&quot;: np.arange(50,110,25),
    &quot;learning_rate&quot;: [0.01,0.1,0.05],
    &quot;base_estimator&quot;: [
        DecisionTreeClassifier(max_depth=2, random_state=1),
        DecisionTreeClassifier(max_depth=3, random_state=1),
    ],
}</code></pre>
<ul>
<li>For Bagging Classifier:</li>
</ul>
<pre><code>param_grid = {
    &#39;max_samples&#39;: [0.8,0.9,1],
    &#39;max_features&#39;: [0.7,0.8,0.9],
    &#39;n_estimators&#39; : [30,50,70],
}</code></pre>
<ul>
<li>For Random Forest:</li>
</ul>
<pre><code>param_grid = {
    &quot;n_estimators&quot;: [50,110,25],
    &quot;min_samples_leaf&quot;: np.arange(1, 4),
    &quot;max_features&quot;: [np.arange(0.3, 0.6, 0.1),&#39;sqrt&#39;],
    &quot;max_samples&quot;: np.arange(0.4, 0.7, 0.1)
}</code></pre>
<ul>
<li>For Decision Trees:</li>
</ul>
<pre><code>param_grid = {
    &#39;max_depth&#39;: np.arange(2,6),
    &#39;min_samples_leaf&#39;: [1, 4, 7],
    &#39;max_leaf_nodes&#39; : [10, 15],
    &#39;min_impurity_decrease&#39;: [0.0001,0.001]
}</code></pre>
<ul>
<li>For XGBoost (optional):</li>
</ul>
<pre><code>param_grid={&#39;n_estimators&#39;:np.arange(50,110,25),
            &#39;scale_pos_weight&#39;:[1,2,5],
            &#39;learning_rate&#39;:[0.01,0.1,0.05],
            &#39;gamma&#39;:[1,3],
            &#39;subsample&#39;:[0.7,0.9]
}</code></pre>
</div>
<section id="sample-tuning-method-for-decision-tree-with-original-data"
class="cell markdown" id="GMReRXdH_YUd">
<h4>Sample tuning method for Decision tree with original data</h4>
</section>
<div class="cell code" data-execution_count="364">
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="365">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>scorer <span class="op">=</span> metrics.make_scorer(metrics.recall_score)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="366" id="o9kks1hG_Xhy">
<div class="sourceCode" id="cb124"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: np.arange(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_leaf_nodes&#39;</span> : [<span class="dv">10</span>,<span class="dv">15</span>],</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_impurity_decrease&#39;</span>: [<span class="fl">0.0001</span>,<span class="fl">0.001</span>] }</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_iter<span class="op">=</span><span class="dv">10</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train,y_train)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stderr">
<pre><code>0.01s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.01s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
0.00s - Debugger warning: It seems that frozen modules are being used, which may
0.00s - make the debugger miss breakpoints. Please pass -Xfrozen_modules=off
0.00s - to python to disable frozen modules.
0.00s - Note: Debugging will proceed. Set PYDEVD_DISABLE_FILE_VALIDATION=1 to disable this validation.
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;min_samples_leaf&#39;: 7, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 5} with CV score=0.75:
CPU times: user 457 ms, sys: 807 ms, total: 1.26 s
Wall time: 3.04 s
</code></pre>
</div>
</div>
<section
id="sample-tuning-method-for-decision-tree-with-oversampled-data"
class="cell markdown" id="chN8hbfThKyr">
<h4>Sample tuning method for Decision tree with oversampled data</h4>
</section>
<div class="cell code" data-execution_count="367" id="tVZcJ0hv4jau">
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: np.arange(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_leaf_nodes&#39;</span> : [<span class="dv">10</span>,<span class="dv">15</span>],</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_impurity_decrease&#39;</span>: [<span class="fl">0.0001</span>,<span class="fl">0.001</span>] }</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_iter<span class="op">=</span><span class="dv">10</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train_over,y_train_over)</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;min_samples_leaf&#39;: 7, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 5} with CV score=0.9088344426675887:
</code></pre>
</div>
</div>
<section
id="sample-tuning-method-for-decision-tree-with-undersampled-data"
class="cell markdown" id="HtPIiIS7hKyr">
<h4>Sample tuning method for Decision tree with undersampled data</h4>
</section>
<div class="cell code" data-execution_count="368" id="5pbdykhHhKyr">
<div class="sourceCode" id="cb129"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: np.arange(<span class="dv">2</span>,<span class="dv">6</span>),</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;max_leaf_nodes&#39;</span> : [<span class="dv">10</span>,<span class="dv">15</span>],</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;min_impurity_decrease&#39;</span>: [<span class="fl">0.0001</span>,<span class="fl">0.001</span>] }</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_iter<span class="op">=</span><span class="dv">10</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train_un,y_train_un)</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;min_samples_leaf&#39;: 4, &#39;min_impurity_decrease&#39;: 0.0001, &#39;max_leaf_nodes&#39;: 15, &#39;max_depth&#39;: 4} with CV score=0.8861538461538462:
</code></pre>
</div>
</div>
<section id="tuning-adaboost-using-undersampled" class="cell markdown">
<h2>Tuning AdaBoost using Undersampled</h2>
</section>
<div class="cell code" data-execution_count="369">
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;n_estimators&quot;</span>: np.arange(<span class="dv">50</span>,<span class="dv">110</span>,<span class="dv">25</span>),</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>],</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;estimator&quot;</span>: [</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Type of scoring used to compare parameter combinations</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>scorer <span class="op">=</span> metrics.make_scorer(metrics.recall_score)</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, n_iter<span class="op">=</span><span class="dv">50</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train_un,y_train_un) <span class="co">## Complete the code to fit the model on original data</span></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;n_estimators&#39;: 75, &#39;learning_rate&#39;: 0.1, &#39;estimator&#39;: DecisionTreeClassifier(max_depth=3, random_state=1)} with CV score=0.96:
CPU times: user 528 ms, sys: 47.5 ms, total: 576 ms
Wall time: 3.92 s
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="370">
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating new pipeline with best parameters</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>tuned_adb_un <span class="op">=</span> AdaBoostClassifier(</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">75</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    base_estimator<span class="op">=</span>DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code with the best parameters obtained from tuning</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>tuned_adb_un.fit(</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    X_train_un, y_train_un</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>)  </span></code></pre></div>
<div class="output execute_result" data-execution_count="370">
<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=3,
                                                         random_state=1),
                   learning_rate=0.1, n_estimators=75, random_state=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">AdaBoostClassifier</label><div class="sk-toggleable__content"><pre>AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=3,
                                                         random_state=1),
                   learning_rate=0.1, n_estimators=75, random_state=1)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" ><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">base_estimator: DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(max_depth=3, random_state=1)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" ><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(max_depth=3, random_state=1)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="371">
<div class="sourceCode" id="cb134"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>adb_train_un <span class="op">=</span> model_performance_classification_sklearn(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    tuned_adb_un, X_train_un, y_train_un</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>)  </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>adb_train_un</span></code></pre></div>
<div class="output execute_result" data-execution_count="371">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.984</td>
      <td>0.985</td>
      <td>0.983</td>
      <td>0.984</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="372">
<div class="sourceCode" id="cb135"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking model&#39;s performance on validation set</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>adb_val_un <span class="op">=</span> model_performance_classification_sklearn(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    tuned_adb_un, X_val, y_val</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to check the performance on validation set</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>adb_val_un</span></code></pre></div>
<div class="output execute_result" data-execution_count="372">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.944</td>
      <td>0.951</td>
      <td>0.762</td>
      <td>0.846</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="tuning-with-ada-original" class="cell markdown">
<h2>Tuning with Ada Original</h2>
</section>
<div class="cell code" data-execution_count="373">
<div class="sourceCode" id="cb136"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> AdaBoostClassifier(random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;n_estimators&quot;</span>: np.arange(<span class="dv">50</span>,<span class="dv">110</span>,<span class="dv">25</span>),</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;learning_rate&quot;</span>: [<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>],</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;estimator&quot;</span>: [</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>        DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Type of scoring used to compare parameter combinations</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>scorer <span class="op">=</span> metrics.make_scorer(metrics.recall_score)</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, n_iter<span class="op">=</span><span class="dv">50</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train,y_train) <span class="co">## Complete the code to fit the model on original data</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;n_estimators&#39;: 100, &#39;learning_rate&#39;: 0.1, &#39;estimator&#39;: DecisionTreeClassifier(max_depth=3, random_state=1)} with CV score=0.8692307692307691:
CPU times: user 1.71 s, sys: 92.2 ms, total: 1.8 s
Wall time: 10.6 s
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="374">
<div class="sourceCode" id="cb138"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating new pipeline with best parameters</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>tuned_adb <span class="op">=</span> AdaBoostClassifier(</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    base_estimator<span class="op">=</span>DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code with the best parameters obtained from tuning</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>tuned_adb.fit(X_train, y_train)  <span class="co">## Complete the code to fit the model on original data</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="374">
<style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=3,
                                                         random_state=1),
                   learning_rate=0.1, n_estimators=100, random_state=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" ><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">AdaBoostClassifier</label><div class="sk-toggleable__content"><pre>AdaBoostClassifier(base_estimator=DecisionTreeClassifier(max_depth=3,
                                                         random_state=1),
                   learning_rate=0.1, n_estimators=100, random_state=1)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" ><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">base_estimator: DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(max_depth=3, random_state=1)</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox" ><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(max_depth=3, random_state=1)</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="375">
<div class="sourceCode" id="cb139"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>adb_train <span class="op">=</span> model_performance_classification_sklearn(</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>    tuned_adb, X_train, y_train</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to check the performance on training set</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>adb_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="375">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.985</td>
      <td>0.934</td>
      <td>0.969</td>
      <td>0.951</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="376">
<div class="sourceCode" id="cb140"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking model&#39;s performance on validation set</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>adb_val <span class="op">=</span> model_performance_classification_sklearn(</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    tuned_adb, X_val, y_val</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to check the performance on validation set</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>adb_val</span></code></pre></div>
<div class="output execute_result" data-execution_count="376">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.967</td>
      <td>0.856</td>
      <td>0.933</td>
      <td>0.893</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="tuning-xg-booast" class="cell markdown">
<h2>Tuning XG Booast</h2>
</section>
<div class="cell code" data-execution_count="377">
<div class="sourceCode" id="cb141"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># defining model</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>Model <span class="op">=</span> XGBClassifier(random_state<span class="op">=</span><span class="dv">1</span>,eval_metric<span class="op">=</span><span class="st">&#39;logloss&#39;</span>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Parameter grid to pass in RandomSearchCV</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>param_grid<span class="op">=</span>{<span class="st">&#39;n_estimators&#39;</span>:np.arange(<span class="dv">50</span>,<span class="dv">110</span>,<span class="dv">25</span>),</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;scale_pos_weight&#39;</span>:[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>],</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;learning_rate&#39;</span>:[<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>],</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;gamma&#39;</span>:[<span class="dv">1</span>,<span class="dv">3</span>],</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;subsample&#39;</span>:[<span class="fl">0.7</span>,<span class="fl">0.9</span>]</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Type of scoring used to compare parameter combinations</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>scorer <span class="op">=</span> metrics.make_scorer(metrics.recall_score)</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Calling RandomizedSearchCV</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>randomized_cv <span class="op">=</span> RandomizedSearchCV(estimator<span class="op">=</span>Model, param_distributions<span class="op">=</span>param_grid, n_iter<span class="op">=</span><span class="dv">50</span>, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, scoring<span class="op">=</span>scorer, cv<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting parameters in RandomizedSearchCV</span></span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>randomized_cv.fit(X_train,y_train) <span class="co">## Complete the code to fit the model on original data</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best parameters are </span><span class="sc">{}</span><span class="st"> with CV score=</span><span class="sc">{}</span><span class="st">:&quot;</span> .<span class="bu">format</span>(randomized_cv.best_params_,randomized_cv.best_score_))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best parameters are {&#39;subsample&#39;: 0.7, &#39;scale_pos_weight&#39;: 5, &#39;n_estimators&#39;: 75, &#39;learning_rate&#39;: 0.05, &#39;gamma&#39;: 3} with CV score=0.9353846153846155:
CPU times: user 1 s, sys: 481 ms, total: 1.48 s
Wall time: 3.34 s
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="378">
<div class="sourceCode" id="cb143"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>tuned_xgb <span class="op">=</span> XGBClassifier(</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    eval_metric<span class="op">=</span><span class="st">&quot;logloss&quot;</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    subsample<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    scale_pos_weight<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    n_estimators<span class="op">=</span><span class="dv">75</span>,</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    learning_rate<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    gamma<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code with the best parameters obtained from tuning</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>tuned_xgb.fit(X_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="378">
<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,
              feature_types=None, gamma=3, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.05, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=75,
              n_jobs=None, num_parallel_tree=None, random_state=1, ...)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox" checked><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">XGBClassifier</label><div class="sk-toggleable__content"><pre>XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=&#x27;logloss&#x27;,
              feature_types=None, gamma=3, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.05, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=75,
              n_jobs=None, num_parallel_tree=None, random_state=1, ...)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="379">
<div class="sourceCode" id="cb144"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>xgb_train <span class="op">=</span> model_performance_classification_sklearn(tuned_xgb, X_train, y_train)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>xgb_train</span></code></pre></div>
<div class="output execute_result" data-execution_count="379">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.976</td>
      <td>0.992</td>
      <td>0.876</td>
      <td>0.930</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="380">
<div class="sourceCode" id="cb145"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>xgb_val <span class="op">=</span> model_performance_classification_sklearn(tuned_xgb, X_val, y_val)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>xgb_val</span></code></pre></div>
<div class="output execute_result" data-execution_count="380">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.953</td>
      <td>0.930</td>
      <td>0.806</td>
      <td>0.864</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="model-comparison-and-final-model-selection"
class="cell markdown" id="D9JNnpxa4jau">
<h2>Model Comparison and Final Model Selection</h2>
</section>
<div class="cell code" data-execution_count="381" id="0JG85rkY4jav">
<div class="sourceCode" id="cb146"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># training performance comparison</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>models_train_comp_df <span class="op">=</span> pd.concat(</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        xgb_train.T,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        adb_train.T,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        adb_train_un.T,</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>models_train_comp_df.columns <span class="op">=</span> [</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient boosting trained with Original data&quot;</span>,</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AdaBoost trained with Original data&quot;</span>,</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AdaBoost trained with Undersampled data&quot;</span>,</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Training performance comparison:&quot;</span>)</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>models_train_comp_df</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training performance comparison:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="381">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gradient boosting trained with Original data</th>
      <th>AdaBoost trained with Original data</th>
      <th>AdaBoost trained with Undersampled data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Accuracy</th>
      <td>0.976</td>
      <td>0.985</td>
      <td>0.984</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.992</td>
      <td>0.934</td>
      <td>0.985</td>
    </tr>
    <tr>
      <th>Precision</th>
      <td>0.876</td>
      <td>0.969</td>
      <td>0.983</td>
    </tr>
    <tr>
      <th>F1</th>
      <td>0.930</td>
      <td>0.951</td>
      <td>0.984</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="382">
<div class="sourceCode" id="cb148"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation performance comparison</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>models_val_comp_df <span class="op">=</span> pd.concat(</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>        xgb_val.T,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>        adb_val.T,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>        adb_val_un.T,</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>models_val_comp_df.columns <span class="op">=</span> [</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Gradient boosting Val with Original data&quot;</span>,</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AdaBoost Val with Original data&quot;</span>,</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AdaBoost Val with Undersampled data&quot;</span>,</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Validation performance comparison:&quot;</span>)</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>models_val_comp_df</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Validation performance comparison:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="382">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Gradient boosting Val with Original data</th>
      <th>AdaBoost Val with Original data</th>
      <th>AdaBoost Val with Undersampled data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Accuracy</th>
      <td>0.953</td>
      <td>0.967</td>
      <td>0.944</td>
    </tr>
    <tr>
      <th>Recall</th>
      <td>0.930</td>
      <td>0.856</td>
      <td>0.951</td>
    </tr>
    <tr>
      <th>Precision</th>
      <td>0.806</td>
      <td>0.933</td>
      <td>0.762</td>
    </tr>
    <tr>
      <th>F1</th>
      <td>0.864</td>
      <td>0.893</td>
      <td>0.846</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="test-set-final-performance" class="cell markdown"
id="d_pDMFAz4jav">
<h3>Test set final performance</h3>
</section>
<div class="cell code" data-execution_count="383" id="g8-epsXv4jav">
<div class="sourceCode" id="cb150"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> X_train.columns</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> (</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>    tuned_adb_un.feature_importances_</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co">## Complete the code to check the feature importance of the best model</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> np.argsort(importances)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Feature Importances&quot;</span>)</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>plt.barh(<span class="bu">range</span>(<span class="bu">len</span>(indices)), importances[indices], color<span class="op">=</span><span class="st">&quot;violet&quot;</span>, align<span class="op">=</span><span class="st">&quot;center&quot;</span>)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(indices)), [feature_names[i] <span class="cf">for</span> i <span class="kw">in</span> indices])</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Relative Importance&quot;</span>)</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_59ffae685a55473ab45df6a442b26a9d/926e891a8d43709707bb12fe4b5e7d8e6fddac14.png" /></p>
</div>
</div>
<section id="business-insights-and-conclusions" class="cell markdown"
id="c5hPmHyR4jaw">
<h1>Business Insights and Conclusions</h1>
</section>
<div class="cell markdown" id="VB3eO21n_sgt">
<hr />
<p>Best Model is AdaBoost Undersampled We find that Recall Scores are
best for ADA Boost With Undersampled at .951 for Val vs .985 for
Training</p>
<p>Total transaction Amount is the most important feature, followed by
an Transaction Count and Total Revolving Balance</p>
<p>Leveraging the AdaBoost Val with Undersampled data from this
analysis, Thera Bank could identify which customers are at risk for
churning and proactively reach out to them and address their
concerns.</p>
<p>Hence the bank should improve on customer engagements, and give more
incentives for credit cards</p>
</div>
</body>
</html>
